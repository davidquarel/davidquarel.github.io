---
layout: post-custom
title: Dumping ground for benchmarks on GPUs 
date: 2024-10-01
tags:
published: true
---


I don't trust the magic numbers in the datasheets. 

#### NVIDIA RTX A4000

| Size | Precision      | Time (s)           | TFLOPs         |
|------|---------------|--------------------|----------------|
| 1024 | FP32          | 0.0002 ± 0.0000    | 9.70 ± 0.19    |
| 1024 | FP32+TF32     | 0.0001 ± 0.0000    | 18.45 ± 0.18   |
| 1024 | FP16          | 0.0001 ± 0.0000    | 35.59 ± 1.80   |
| 1024 | FP16+TF32     | 0.0001 ± 0.0000    | 37.56 ± 0.62   |
| 1024 | FP16_REDUCED  | 0.0001 ± 0.0000    | 38.20 ± 0.18   |
| 1024 | BF16          | 0.0001 ± 0.0000    | 34.71 ± 1.62   |
| 1024 | BF16+TF32     | 0.0001 ± 0.0000    | 36.17 ± 0.29   |
| 2048 | FP32          | 0.0015 ± 0.0000    | 11.41 ± 0.10   |
| 2048 | FP32+TF32     | 0.0006 ± 0.0000    | 29.47 ± 0.61   |
| 2048 | FP16          | 0.0003 ± 0.0000    | 57.91 ± 0.21   |
| 2048 | FP16+TF32     | 0.0003 ± 0.0000    | 54.99 ± 0.05   |
| 2048 | FP16_REDUCED  | 0.0003 ± 0.0000    | 54.89 ± 0.11   |
| 2048 | BF16          | 0.0003 ± 0.0000    | 55.04 ± 0.10   |
| 2048 | BF16+TF32     | 0.0003 ± 0.0000    | 55.12 ± 0.05   |
| 4096 | FP32          | 0.0153 ± 0.0005    | 9.07 ± 0.35    |
| 4096 | FP32+TF32     | 0.0045 ± 0.0000    | 30.33 ± 0.22   |
| 4096 | FP16          | 0.0021 ± 0.0000    | 65.45 ± 0.03   |
| 4096 | FP16+TF32     | 0.0021 ± 0.0000    | 65.88 ± 0.31   |
| 4096 | FP16_REDUCED  | 0.0022 ± 0.0000    | 63.56 ± 0.10   |
| 4096 | BF16          | 0.0021 ± 0.0000    | 65.33 ± 0.73   |
| 4096 | BF16+TF32     | 0.0021 ± 0.0000    | 64.83 ± 0.07   |
| 8192 | FP32          | 0.0929 ± 0.0006    | 11.84 ± 0.07   |
| 8192 | FP32+TF32     | 0.0364 ± 0.0006    | 30.27 ± 0.46   |
| 8192 | FP16          | 0.0181 ± 0.0003    | 60.78 ± 1.12   |
| 8192 | FP16+TF32     | 0.0179 ± 0.0002    | 61.47 ± 0.66   |
| 8192 | FP16_REDUCED  | 0.0181 ± 0.0003    | 61.00 ± 0.93   |
| 8192 | BF16          | 0.0186 ± 0.0002    | 59.32 ± 0.76   |
| 8192 | BF16+TF32     | 0.0190 ± 0.0001    | 57.89 ± 0.43   |

---

#### NVIDIA GeForce RTX 3090

| Size | Precision      | Time (s)           | TFLOPs         |
|------|---------------|--------------------|----------------|
| 1024 | FP32          | 0.0001 ± 0.0000    | 17.18 ± 0.50   |
| 1024 | FP32+TF32     | 0.0001 ± 0.0000    | 22.42 ± 0.80   |
| 1024 | FP16          | 0.0001 ± 0.0000    | 36.30 ± 1.90   |
| 1024 | FP16+TF32     | 0.0001 ± 0.0000    | 38.56 ± 0.61   |
| 1024 | FP16_REDUCED  | 0.0001 ± 0.0000    | 39.17 ± 0.13   |
| 1024 | BF16          | 0.0001 ± 0.0000    | 36.75 ± 2.05   |
| 1024 | BF16+TF32     | 0.0001 ± 0.0000    | 39.26 ± 0.15   |
| 2048 | FP32          | 0.0007 ± 0.0000    | 23.22 ± 0.47   |
| 2048 | FP32+TF32     | 0.0006 ± 0.0000    | 27.73 ± 0.59   |
| 2048 | FP16          | 0.0003 ± 0.0000    | 54.59 ± 0.12   |
| 2048 | FP16+TF32     | 0.0003 ± 0.0000    | 54.29 ± 0.04   |
| 2048 | FP16_REDUCED  | 0.0003 ± 0.0000    | 61.00 ± 0.08   |
| 2048 | BF16          | 0.0003 ± 0.0000    | 60.83 ± 0.08   |
| 2048 | BF16+TF32     | 0.0003 ± 0.0000    | 61.44 ± 0.27   |
| 4096 | FP32          | 0.0060 ± 0.0002    | 23.17 ± 0.65   |
| 4096 | FP32+TF32     | 0.0045 ± 0.0001    | 30.30 ± 0.47   |
| 4096 | FP16          | 0.0021 ± 0.0000    | 66.67 ± 0.50   |
| 4096 | FP16+TF32     | 0.0021 ± 0.0000    | 66.65 ± 0.07   |
| 4096 | FP16_REDUCED  | 0.0020 ± 0.0000    | 67.63 ± 0.01   |
| 4096 | BF16          | 0.0020 ± 0.0000    | 67.81 ± 0.11   |
| 4096 | BF16+TF32     | 0.0020 ± 0.0000    | 67.25 ± 0.11   |
| 8192 | FP32          | 0.0508 ± 0.0004    | 21.67 ± 0.18   |
| 8192 | FP32+TF32     | 0.0304 ± 0.0002    | 36.24 ± 0.27   |
| 8192 | FP16          | 0.0170 ± 0.0003    | 64.77 ± 1.16   |
| 8192 | FP16+TF32     | 0.0172 ± 0.0001    | 64.08 ± 0.35   |
| 8192 | FP16_REDUCED  | 0.0175 ± 0.0002    | 62.99 ± 0.60   |
| 8192 | BF16          | 0.0166 ± 0.0001    | 66.12 ± 0.31   |
| 8192 | BF16+TF32     | 0.0162 ± 0.0001    | 68.06 ± 0.43   |

---

#### NVIDIA A40

| Size | Precision      | Time (s)           | TFLOPs         |
|------|---------------|--------------------|----------------|
| 1024 | FP32          | 0.0001 ± 0.0000    | 14.79 ± 0.39   |
| 1024 | FP32+TF32     | 0.0001 ± 0.0000    | 32.12 ± 2.10   |
| 1024 | FP16          | 0.0000 ± 0.0000    | 49.54 ± 3.30   |
| 1024 | FP16+TF32     | 0.0000 ± 0.0000    | 53.04 ± 0.31   |
| 1024 | FP16_REDUCED  | 0.0000 ± 0.0000    | 52.95 ± 0.46   |
| 1024 | BF16          | 0.0000 ± 0.0000    | 47.15 ± 3.09   |
| 1024 | BF16+TF32     | 0.0000 ± 0.0000    | 44.51 ± 2.10   |
| 2048 | FP32          | 0.0008 ± 0.0000    | 20.29 ± 0.33   |
| 2048 | FP32+TF32     | 0.0004 ± 0.0000    | 44.98 ± 1.16   |
| 2048 | FP16          | 0.0002 ± 0.0000    | 93.13 ± 0.38   |
| 2048 | FP16+TF32     | 0.0002 ± 0.0000    | 90.48 ± 0.93   |
| 2048 | FP16_REDUCED  | 0.0002 ± 0.0000    | 88.76 ± 0.27   |
| 2048 | BF16          | 0.0002 ± 0.0000    | 88.96 ± 0.36   |
| 2048 | BF16+TF32     | 0.0002 ± 0.0000    | 89.25 ± 0.31   |
| 4096 | FP32          | 0.0060 ± 0.0000    | 22.98 ± 0.09   |
| 4096 | FP32+TF32     | 0.0025 ± 0.0000    | 55.94 ± 0.74   |
| 4096 | FP16          | 0.0012 ± 0.0000    | 111.99 ± 0.20  |
| 4096 | FP16+TF32     | 0.0012 ± 0.0000    | 114.65 ± 0.24  |
| 4096 | FP16_REDUCED  | 0.0012 ± 0.0000    | 114.80 ± 0.24  |
| 4096 | BF16          | 0.0012 ± 0.0000    | 114.89 ± 0.30  |
| 4096 | BF16+TF32     | 0.0012 ± 0.0000    | 114.90 ± 0.25  |
| 8192 | FP32          | 0.0482 ± 0.0001    | 22.83 ± 0.05   |
| 8192 | FP32+TF32     | 0.0185 ± 0.0001    | 59.55 ± 0.17   |
| 8192 | FP16          | 0.0139 ± 0.0001    | 79.35 ± 0.76   |
| 8192 | FP16+TF32     | 0.0139 ± 0.0001    | 79.39 ± 0.55   |
| 8192 | FP16_REDUCED  | 0.0138 ± 0.0001    | 79.54 ± 0.54   |
| 8192 | BF16          | 0.0097 ± 0.0001    | 113.85 ± 1.36  |
| 8192 | BF16+TF32     | 0.0098 ± 0.0001    | 112.31 ± 1.25  |